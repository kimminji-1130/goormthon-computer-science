# 캡슐화와 비캡슐화 (Encapsulation & Decapsulation)

## 캡슐화란?

> 데이터를 상대방에게 보내기 위해 상위 계층에서 하위 계층으로 내려가며 각 계층에서 필요한 정보를 담은 \*\*헤더(Header)\*\*나 \*\*트레일러(Trailer)\*\*를 붙이는 과정이다. 이는 데이터를 네트워크 상에서 **안전하고 효율적으로 전달**하기 위한 프로토콜 동작 방식이다.

### 캡슐화 목적

* 데이터를 정확히 목적지에 전달하기 위해 필요한 정보(주소, 오류 제어 등)를 담기 위함
* 계층별 기능 분리 및 책임 분담
* 네트워크 내 호환성 및 안정성 보장

## 비캡슐화란?

> 수신 측에서 하위 계층에서 상위 계층으로 데이터를 전달하면서 **헤더나 트레일러를 제거**하고,
> 최종적으로 **원본 데이터를 복원**하는 과정이다.

---

## OSI 7계층 기반 캡슐화 & 비캡슐화 흐름
![image](https://github.com/user-attachments/assets/dbc3e77d-4ad9-4496-a53e-83b7f7619a9a)

### 캡슐화 (송신 측)

1. **애플리케이션 계층 (7\~5계층)**

   * 웹 요청/파일 전송/이메일 등 실제 서비스 데이터를 생성
   * PDU: 메시지

2. **전송 계층 (4계층)**

   * TCP 또는 UDP 헤더 추가 (포트 번호 등 포함)
   * 신뢰성 있는 전송 보장
   * PDU: 세그먼트 (TCP), 데이터그램 (UDP)

3. **네트워크 계층 (3계층)**

   * IP 헤더 추가 (송신/수신 IP 주소 등 포함)
   * PDU: 패킷

4. **데이터 링크 계층 (2계층)**

   * MAC 주소 등 포함된 헤더와 트레일러 추가
   * 오류 감지 기능 제공 (트레일러)
   * PDU: 프레임

5. **물리 계층 (1계층)**

   * 비트 형태로 변환되어 전기/광 신호로 송신됨

### 비캡슐화 (수신 측)

1. **물리 계층**: 신호 수신 → 비트로 변환
2. **데이터 링크 계층**: 프레임 트레일러와 헤더 제거 → 패킷 전달
3. **네트워크 계층**: IP 헤더 제거 → 세그먼트 전달
4. **전송 계층**: 포트 정보 확인 후 헤더 제거 → 메시지 전달
5. **애플리케이션 계층**: 최종적으로 원래의 데이터 획득

---

## PDU (Protocol Data Unit)

각 계층에서 데이터를 주고받을 때 사용하는 단위이며, 보통 다음과 같이 정의된다.

| 계층        | PDU 명칭        |
| --------- | ------------- |
| 애플리케이션 계층 | 메시지 (Message) |
| 전송 계층     | 세그먼트 / 데이터그램  |
| 네트워크 계층   | 패킷 (Packet)   |
| 링크 계층     | 프레임 (Frame)   |
| 물리 계층     | 비트 (Bit)      |

---

## 면접 예상 질문 & 답변 보기

<details>
<summary>캡슐화란 무엇인가요?</summary>
캡슐화는 네트워크 계층에서 데이터를 전달할 때 각 계층마다 필요한 제어 정보를 헤더/트레일러로 붙여 데이터를 감싸는 과정입니다. 이를 통해 데이터가 정확하게 목적지까지 전달될 수 있도록 합니다.
</details>

<details>
<summary>비캡슐화란 무엇인가요?</summary>
비캡슐화는 수신 측에서 하위 계층부터 상위 계층으로 데이터를 전달하며 각 계층에서 헤더/트레일러를 제거하여 원래의 데이터를 복원하는 과정입니다.
</details>

<details>
<summary>데이터 캡슐화를 하는 이유는 무엇인가요?</summary>
각 계층에서 필요한 정보를 포함시켜 통신의 신뢰성, 오류 제어, 데이터 호환성 등을 확보하기 위함입니다.
</details>

<details>
<summary>캡슐화 과정에서 생성되는 데이터 단위는 무엇인가요?</summary>
계층별로 메시지 → 세그먼트 → 패킷 → 프레임 → 비트 순으로 전환됩니다. 각 단계마다 해당 계층의 헤더가 추가됩니다.
</details>

<details>
<summary>트레일러란 무엇인가요?</summary>
트레일러는 주로 데이터 링크 계층에서 사용되며, 데이터 끝에 붙는 정보로 오류 검출 등을 위해 사용됩니다.
</details>

