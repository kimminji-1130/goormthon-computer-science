# NAT에 대해서 ✅

# 공인 IP와 사설 IP에 대한 차이, 핵심만 알아보자

**핵심적인 차이점은 어느 인터넷에 포함되어 있느냐에 따라, 공인 IP냐 사설 IP냐로 구분할 수 있음.**

![image.png](NAT%E1%84%8B%E1%85%A6%20%E1%84%83%E1%85%A2%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E2%9C%85%2020018fdf38ed80bebc93eb154d71627e/image.png)

# NAT(Network Address Translation)에 대해서

- **NAT를 왜 사용해야할까?**
    
    ![image.png](NAT%E1%84%8B%E1%85%A6%20%E1%84%83%E1%85%A2%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E2%9C%85%2020018fdf38ed80bebc93eb154d71627e/image%201.png)
    
    - 사설 IP는 인터넷에 직접 연결할 수 없고, 반드시 NAT를 통해 공인 IP로 변환해야 외부와 통신이 가능.
    부가적인 이익으로는 인터넷 환경에서의 공인 IP 절약, 내부 네트워크 구조 숨김 등이 있음.

- **NAT의 종류**
    
    ![image.png](NAT%E1%84%8B%E1%85%A6%20%E1%84%83%E1%85%A2%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E2%9C%85%2020018fdf38ed80bebc93eb154d71627e/image%202.png)
    
    - **Static NAT (정적 NAT):** 1:1로 사설 IP와 공인 IP를 고정적으로 매핑. 외부에서 내부로의 접근도 가능.
    - **Dynamic NAT (동적 NAT):** 사설 IP를 공인 IP 풀에서 동적으로 매핑.
    - **NAPT/PAT (Port Address Translation):** 여러 사설 IP가 하나의 공인 IP로 인터넷에 접속. (가장 일반적인 공유기 방식)

- **그런데, 여러 사용자가 하나의 PAT를 통해 외부와 통신하다 보면, 하나의 IP로 같은 요청이 가는 경우의 수가 발생.**
    
    **서로 다른 포트 번호를 사용하게 됨.**
    
    ![image.png](NAT%E1%84%8B%E1%85%A6%20%E1%84%83%E1%85%A2%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E2%9C%85%2020018fdf38ed80bebc93eb154d71627e/image%203.png)
    
    - **정리해 볼까요?**
        
        1) Client에서 TCP/IP 프로토콜 규격에 맞는 데이터로 만들기 위해 캡슐화 하는 과정에서 OS가 시스템 콜을 호출해 임의 포트를 할당하는 단계 (사설 IP)
        2) 패킷이 라우터에서 PAT돼 외부로 통신될 때 클라이언트 간 요청 식별을 위한 Port를 할당하는 단계 (공인 IP)
        
        ![image.png](NAT%E1%84%8B%E1%85%A6%20%E1%84%83%E1%85%A2%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E2%9C%85%2020018fdf38ed80bebc93eb154d71627e/image%204.png)
        

- **SNAT와 Static NAT, DNAT와 Dynamic NAT는 다르다.**
    
    ![image.png](NAT%E1%84%8B%E1%85%A6%20%E1%84%83%E1%85%A2%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E2%9C%85%2020018fdf38ed80bebc93eb154d71627e/image%205.png)
    
    - SNAT는 Source NAT로 내부 네트워크에서 외부로 나가는 패킷의 출발지 주소를 공인 IP로 바꿔줍니다. 일반적으로 회사, 학교, 가정 등에서 내부 장치들이 인터넷에 접속할 때 사용됩니다.
    - DNAT는 Destination NAT로 외부에서 내부 네트워크로 들어오는 패킷의 목적지 주소를 내부의 특정 사설 IP로 바꿔줍니다. 내부 서버(웹, 게임 등)를 외부에 공개할 때 주로 사용합니다.

- **한 번쯤 들어봤을 포트 포워딩(Port Forwarding)에 대해서**
    
    ![image.png](NAT%E1%84%8B%E1%85%A6%20%E1%84%83%E1%85%A2%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E2%9C%85%2020018fdf38ed80bebc93eb154d71627e/image%206.png)
    
    - 포트 포워딩은 DNAT의 한 형태
    - 외부에서 특정 공인 IP와 포트로 들어오는 트래픽을 내부 네트워크의 특정 사설 IP와 포트로 전달하는 기능입니다.
    - 포트 포워딩 남발하면 보안취약점 발생. (포트 스캔을 통해 보안 취약점 발견 → 결국 공격 대상이 됨.)

# 면접 관련 예상 질문

**Q1. NAT란 무엇이며, 왜 필요한가?**

A. NAT(Network Address Translation)는 내부 네트워크의 사설 IP 주소와 외부 네트워크의 공인 IP 주소를 서로 변환하는 기술입니다. IPv4 주소 부족 문제를 해결하고, 내부 네트워크 구조를 외부에 숨겨 보안을 강화하기 위해 필요합니다.

**Q2. 사설 IP와 공인 IP의 차이점은?**

A. 공인 IP는 인터넷에서 유일하며 외부에서 직접 접근이 가능합니다. 사설 IP는 내부 네트워크에서만 사용되고, 외부에서는 직접 접근할 수 없습니다. 사설 IP는 반드시 NAT를 거쳐야 인터넷 접속이 가능합니다.

**Q3. NAT의 주요 동작 방식은?**

A. 내부 장치가 인터넷에 접속할 때, 라우터가 사설 IP를 공인 IP로 변환해 패킷을 전송하고, 외부에서 응답이 오면 다시 사설 IP로 변환해 내부 장치에 전달합니다.

**Q4. NAT의 종류에는 무엇이 있나?**

A. 주요 종류로는 Static NAT(1:1 고정 매핑), Dynamic NAT(동적 매핑), PAT/NAPT(여러 사설 IP를 하나의 공인 IP와 포트로 매핑)가 있습니다.

**Q5. SNAT와 DNAT의 차이점은?**

A. SNAT(Source NAT)는 내부에서 외부로 나가는 트래픽의 출발지 IP를 변환합니다. DNAT(Destination NAT)는 외부에서 내부로 들어오는 트래픽의 목적지 IP를 변환합니다.

**Q6. Port Forwarding(포트포워딩)이란?**

A. 포트포워딩은 DNAT의 한 형태로, 외부에서 특정 포트로 들어오는 트래픽을 내부 네트워크의 특정 장치와 포트로 전달하는 기능입니다. 내부 서버(웹, 게임 등)를 외부에 공개할 때 사용됩니다.

**Q7. NAT의 장점과 단점은?**

A. 장점은 IP 주소의 효율적 사용, 내부 네트워크 보안 강화입니다. 단점은 일부 서비스(VPN, VoIP 등)에서의 호환성 문제, 서버 운영 시 외부 접근의 복잡성 등이 있습니다.

**Q8. NAT 환경에서 내부 서버에 외부에서 접근하려면?**

A. 라우터에서 포트포워딩(DNAT)을 설정해 외부에서 들어오는 트래픽을 내부 서버로 전달해야 합니다.

https://baobab-tree.notion.site/NAT-20018fdf38ed80bebc93eb154d71627e?pvs=4